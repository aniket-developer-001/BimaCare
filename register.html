<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Create Account</title>

<link rel="stylesheet" href="style.css">

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* ===== Popup Modal ===== */
.modalBg{
  position:fixed;
  inset:0;
  background:rgba(2,6,23,0.55);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
  z-index:999999;
  opacity:0;
  pointer-events:none;
  transition:0.2s ease;
}

.modalBg.show{
  opacity:1;
  pointer-events:auto;
}

.modalBox{
  width:100%;
  max-width:360px;
  background:#fff;
  border-radius:22px;
  padding:18px;
  box-shadow:0 22px 60px rgba(0,0,0,0.25);
  border:1px solid rgba(0,0,0,0.08);
  transform:scale(0.96);
  transition:0.2s ease;
  text-align:center;
}

.modalBg.show .modalBox{
  transform:scale(1);
}

.modalIcon{
  width:62px;
  height:62px;
  border-radius:22px;
  margin:0 auto 12px auto;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(37,99,235,0.10);
  border:1px solid rgba(37,99,235,0.18);
}

.modalIcon i{
  font-size:26px;
  color:#2563eb;
}

.modalBox h3{
  font-size:16px;
  font-weight:1000;
  color:#0A1A3C;
}

.modalBox p{
  margin-top:8px;
  font-size:13px;
  font-weight:900;
  color:#64748b;
  line-height:1.4;
}

.loaderLine{
  margin-top:14px;
  width:100%;
  height:10px;
  border-radius:999px;
  background:#eef2ff;
  overflow:hidden;
  border:1px solid rgba(37,99,235,0.15);
}

.loaderFill{
  width:0%;
  height:100%;
  border-radius:999px;
  background:linear-gradient(135deg,#2563eb,#7c3aed);
  transition:0.2s linear;
}

.timeText{
  margin-top:10px;
  font-size:12px;
  font-weight:1000;
  color:#475569;
}.otpInput {
  width: 42px;
  height: 48px;
  text-align: center;
  font-size: 18px;
  font-weight: 900;
  border-radius: 12px;
  border: 1px solid #cbd5e1;
}
</style>

</head>
<body>

  <div class="box">

    <h2>Create Account</h2>

    <div class="field">
      <div class="inputBox">
        <i class="fa-solid fa-user"></i>
        <input id="name" type="text" placeholder="Name">
      </div>
      <div class="err" id="nameErr">Please enter your full name</div>
    </div>

    <!-- âœ… AGE + CIBIL FLEX ROW -->
    <div class="flexRow">

      <!-- AGE -->
      <div class="field" style="margin-bottom:0;">
        <div class="inputBox">
          <i class="fa-solid fa-cake-candles"></i>
          <input id="age" type="tel" placeholder="Age (Year)" maxlength="2">
        </div>
        <div class="err" id="ageErr">Enter valid age (10-99)</div>
      </div>

      <!-- CIBIL -->
      <div class="field" style="margin-bottom:0;">
        <div class="inputBox">
          <i class="fa-solid fa-gauge-high"></i>
          <input id="cibil" type="tel" placeholder="CIBIL SCORE" maxlength="3">
        </div>
        <div class="err" id="cibilErr">Enter valid CIBIL (300-900)</div>

        <a href="https://www.cibil.com/freecibilscore" target="_blank" class="miniLink">
          <i class="fa-solid fa-arrow-up-right-from-square"></i> CIBIL Check?
        </a>
      </div>

    </div>

    <div class="field">
      <div class="inputBox">
        <i class="fa-solid fa-phone"></i>
        <input id="phone" type="tel" placeholder="Phone Number" maxlength="10">
      </div>
      <div class="err" id="phoneErr">Enter a valid 10-digit phone number</div>
    </div>

    <button class="btn btnPrimary" id="createBtn">
      Create Account <i class="fa fa-arrow-circle-right"></i>
    </button>

  </div>


<!-- âœ… SUCCESS POPUP -->
<div class="modalBg" id="successModal">
  <div class="modalBox">
    <div class="modalIcon">
      <i class="fa-solid fa-circle-check"></i>
    </div>

    <h3>Account Created Successfully!</h3>
    <p>Welcome to BimaCare<br>Redirecting to Home...</p>

    <div class="loaderLine">
      <div class="loaderFill" id="loaderFill"></div>
    </div>

    <div class="timeText">
      Opening in <span id="secLeft">5</span> seconds...
    </div>
  </div>
</div>
<!-- âœ… OTP SECTION -->
<div class="box" id="otpBox" style="display:none;">
  
  <h2>Verify OTP</h2>
  
  <div style="display:flex; gap:8px; justify-content:center; margin-top:20px;">
    <input class="otpInput" maxlength="1">
    <input class="otpInput" maxlength="1">
    <input class="otpInput" maxlength="1">
    <input class="otpInput" maxlength="1">
    <input class="otpInput" maxlength="1">
    <input class="otpInput" maxlength="1">
  </div>
  
  
  <button class="btn btnPrimary" id="verifyOtpBtn" style="margin-top:14px;">
    Verify OTP
  </button>
  
  <p style="margin-top:12px; font-size:13px;">
    Didn't receive OTP?
    <span id="resendOtp" style="font-weight:900;">
  Resend OTP
</span>
  </p>
  
</div>

<script>
  /* ============================= */
/* ===== INPUT REFERENCES ====== */
/* ============================= */

const nameInput = document.getElementById("name");
const phoneInput = document.getElementById("phone");
const ageInput = document.getElementById("age");
const cibilInput = document.getElementById("cibil");

const nameErr = document.getElementById("nameErr");
const phoneErr = document.getElementById("phoneErr");
const ageErr = document.getElementById("ageErr");
const cibilErr = document.getElementById("cibilErr");

const successModal = document.getElementById("successModal");
const loaderFill = document.getElementById("loaderFill");
const secLeft = document.getElementById("secLeft");

const otpBox = document.getElementById("otpBox");
const otpInputs = document.querySelectorAll(".otpInput");
const verifyOtpBtn = document.getElementById("verifyOtpBtn");
const resendOtp = document.getElementById("resendOtp");

/* ============================= */
/* ===== AUTO LOGIN CHECK ====== */
/* ============================= */

if (localStorage.getItem("is_logged_in") === "yes") {
  window.location.href = "https://aniket-developer-001.github.io/BimaCare/home.html";
}

/* ============================= */
/* ===== INPUT FILTERS ========= */
/* ============================= */

phoneInput.addEventListener("input", () => {
  phoneInput.value = phoneInput.value.replace(/[^0-9]/g, "").slice(0, 10);
});

ageInput.addEventListener("input", () => {
  ageInput.value = ageInput.value.replace(/[^0-9]/g, "").slice(0, 2);
});

cibilInput.addEventListener("input", () => {
  cibilInput.value = cibilInput.value.replace(/[^0-9]/g, "").slice(0, 3);
});

/* ============================= */
/* ===== VALIDATION ============ */
/* ============================= */

function validate() {
  
  let ok = true;
  
  if (nameInput.value.trim().length < 3) {
    nameErr.style.display = "block";
    ok = false;
  } else nameErr.style.display = "none";
  
  if (!/^[0-9]{10}$/.test(phoneInput.value.trim())) {
    phoneErr.style.display = "block";
    ok = false;
  } else phoneErr.style.display = "none";
  
  const ageVal = parseInt(ageInput.value.trim());
  if (!ageVal || ageVal < 10 || ageVal > 99) {
    ageErr.style.display = "block";
    ok = false;
  } else ageErr.style.display = "none";
  
  const cibilVal = parseInt(cibilInput.value.trim());
  if (!cibilVal || cibilVal < 300 || cibilVal > 900) {
    cibilErr.style.display = "block";
    ok = false;
  } else cibilErr.style.display = "none";
  
  return ok;
}

/* ============================= */
/* ===== SUCCESS REDIRECT ====== */
/* ============================= */

function showSuccessPopupAndRedirect() {
  
  successModal.classList.add("show");
  
  let total = 5;
  let left = total;
  
  secLeft.innerText = left;
  loaderFill.style.width = "0%";
  
  const interval = setInterval(() => {
    
    left--;
    secLeft.innerText = left;
    
    loaderFill.style.width = ((total - left) / total) * 100 + "%";
    
    if (left <= 0) {
      clearInterval(interval);
      window.location.href = "https://aniket-developer-001.github.io/BimaCare/home.html";
    }
    
  }, 1000);
}

/* ============================= */
/* ===== OTP SYSTEM ============ */
/* ============================= */

let generatedOTP = "";
let otpInterval;

/* ðŸ”¹ Generate OTP */
function generateOTP() {
  generatedOTP = Math.floor(100000 + Math.random() * 900000).toString();
  console.log("Generated OTP:", generatedOTP);
  alert(generatedOTP);
}

/* ðŸ”¹ Countdown inside resend */
function startOtpTimer() {
  
  let time = 30;
  
  resendOtp.style.color = "#94a3b8";
  resendOtp.style.cursor = "not-allowed";
  resendOtp.style.pointerEvents = "none";
  resendOtp.innerText = `Resend OTP (${time}s)`;
  
  clearInterval(otpInterval);
  
  otpInterval = setInterval(() => {
    
    time--;
    
    if (time > 0) {
      resendOtp.innerText = `Resend OTP (${time}s)`;
    }
    
    if (time <= 0) {
      clearInterval(otpInterval);
      resendOtp.innerText = "Resend OTP";
      resendOtp.style.color = "#2563eb";
      resendOtp.style.cursor = "pointer";
      resendOtp.style.pointerEvents = "auto";
    }
    
  }, 1000);
}

/* ðŸ”¹ OTP auto focus */
otpInputs.forEach((input, index) => {
  
  input.addEventListener("input", () => {
    
    input.value = input.value.replace(/[^0-9]/g, "");
    
    if (input.value && index < otpInputs.length - 1) {
      otpInputs[index + 1].focus();
    }
    
  });
  
});

/* ============================= */
/* ===== CREATE ACCOUNT CLICK == */
/* ============================= */

document.getElementById("createBtn").addEventListener("click", () => {
  
  if (!validate()) return;
  
  localStorage.setItem("user_name", nameInput.value.trim());
  localStorage.setItem("user_phone", phoneInput.value.trim());
  localStorage.setItem("user_age", ageInput.value.trim());
  localStorage.setItem("user_cibil", cibilInput.value.trim());
  
  document.querySelector(".box").style.display = "none";
  otpBox.style.display = "block";
  
  generateOTP();
  startOtpTimer();
});

/* ============================= */
/* ===== VERIFY OTP ============ */
/* ============================= */

verifyOtpBtn.addEventListener("click", () => {
  
  let enteredOTP = "";
  
  otpInputs.forEach(input => {
    enteredOTP += input.value;
  });
  
  if (enteredOTP === generatedOTP) {
    
    localStorage.setItem("is_logged_in", "yes");
    
    successModal.querySelector("h3").innerText = "OTP Verified!";
    successModal.querySelector("p").innerText =
      "OTP validated successfully âœ”";
    
    successModal.classList.add("show");
    
    setTimeout(() => {
      
      successModal.querySelector("h3").innerText =
        "Account Created Successfully!";
      
      successModal.querySelector("p").innerHTML =
        "Welcome to BimaCare <br>Redirecting to Home...";
      
      showSuccessPopupAndRedirect();
      
    }, 2000);
    
  } else {
    
    successModal.querySelector("h3").innerText = "Invalid OTP!";
    successModal.querySelector("p").innerText =
      "The OTP you entered is incorrect. Please try again.";
    
    successModal.classList.add("show");
    
    setTimeout(() => {
      successModal.classList.remove("show");
    }, 2000);
  }
  
});

/* ============================= */
/* ===== RESEND OTP ============ */
/* ============================= */

resendOtp.addEventListener("click", () => {
  
  if (resendOtp.style.pointerEvents === "none") return;
  
  generateOTP();
  startOtpTimer();
  
});
</script>

</body>
</html>